# dam install

Команда устанавливает выбранное приложение из файла, либо репозитория docker.
В аргументах может быть указан тэг, а также архив с приложением.
И в том и другом случае образ приложения загружается из источника в кэш докера.
Таким источником соответственно являются docker registry и сам файл архив.
В случае, когда приложение не загрузилось из registry, утилита подразумевает,
 что образ приложения мог остаться в кэше докера,
 поэтому выводит предупреждение и переходит к следующему этапу установки.

Перед установкой утилита проверяет, что в docker images присутствует образ приложения.
Если репозиторий указанный в тэге не совпадает с дефолтным, происходит ошибка.
Но из файла-архива может быть установленно приложение с любым тэгом.
При этом создается новый репозиторий (если его еще нет в базе) с именем,
где префикс взят из конфига утилиты плюс порядковый номер. А поле `server` берется из тэга.

Далее проверяются метки приложения:
- family
- multiversion

Более подробно по меткам см. ниже.

Начинается этап установки приложения из кэша докера:
- копируется meta из образа в текущую директорию ./.tmp.meta
- проверяется существование install и uninstall
- выводится в stdout файл DESCRIPTION
- из /meta запускается скрипт install, который устанавливает приложение
- приложение сохраняется в базу
- временные файлы удаляются

## Family 
Метка family является строкой.
В значении метки могут быть использованы только прописные буквы и цифры.
Если метка не указана, при установке ее значением будет являться имя приложения.
Значение метки сравнивается с существующими значениями меток приложений в базе.
Если есть совпадение с метками в базе, то утилита не может поставить приложение.
Этот случай означает, что устанавливаемое приложение не совместимо с установленными в систему. 
Либо версия этого приложения уже установлена.

Метка создается, для контроля совместимости приложений в системе.

## Multiversion
Метка принимает булево значение. По умолчанию, значение false.
Задачей метки, является разрешить установку нескольких версий приложения, принадлежащих одной family.
Это означает, что если значение метки true, то утилита не делает сверку family c базой.

Комбинация меток multiversion и family дает гибкости для набора приложений, а так же соответствующий контроль версий

## Official registry

- Если репозиторий официальный, то у тега нет указания registry
- docker login не делается